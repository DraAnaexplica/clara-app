/* ARQUIVO CSS FINAL (baseado no MELHORADO com adições/adaptações do ATUAL) */

body {
    margin: 0;
    padding: 0;
    font-family: "Segoe UI", sans-serif;
    /* Fundo do WhatsApp (do ATUAL) */
    background-color: #efeae2;
    background-image: url("data:image/svg+xml,%3Csvg width='100%25' height='100%25' viewBox='0 0 800 800' xmlns='http://www.w3.org/2000/svg'%3E%3Cdefs%3E%3Cpattern id='a' width='16' height='16' patternUnits='userSpaceOnUse'%3E%3Cpath d='M4 0H12L2.0000000000000004 16H0L8 8L4 0Z' fill='%23e0d8c8'/%3E%3C/pattern%3E%3C/defs%3E%3Crect fill='url(%23a)' width='800' height='800'/%3E%3C/svg%3E");
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    height: 100dvh; /* Unidade mais moderna */
    overflow: hidden; /* Previne scroll no body */
}

/* Container principal (do MELHORADO, mas ocupando tela toda em mobile) */
.chat-container {
    width: 100%;
    height: 100%;
    max-width: 600px; /* Limite em telas maiores (do ATUAL) */
    max-height: 100dvh;
    background-color: #fff;
    display: flex;
    flex-direction: column;
    border-radius: 0; /* Sem borda arredondada em tela cheia */
    box-shadow: 0 0 10px rgba(0,0,0,0.1); /* Sombra sutil */
    overflow: hidden; /* Garante que conteúdo não vaze */
    position: relative; /* Para contexto de posicionamento do modal */
}
@media (min-width: 601px) {
    .chat-container {
        max-height: 95vh; /* Limita altura em desktop */
        border-radius: 8px;
    }
}

/* Header (do MELHORADO, com ajustes) */
.chat-header {
    background-color: #075e54; /* Cor WhatsApp */
    color: white;
    padding: 10px 15px; /* Padding do ATUAL */
    padding-top: calc(10px + env(safe-area-inset-top)); /* Safe area */
    display: flex;
    align-items: center;
    gap: 12px; /* Espaçamento do ATUAL */
    position: sticky; /* Manter fixo (do ATUAL) */
    top: 0;
    z-index: 1000;
    box-shadow: 0 1px 2px rgba(0,0,0,0.1); /* Sombra sutil */
    flex-shrink: 0; /* Não encolher */
}

.clara-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    object-fit: cover;
    border: 1px solid rgba(255, 255, 255, 0.5); /* Borda sutil */
    cursor: pointer; /* Indica que é clicável */
}

.header-info {
    display: flex;
    flex-direction: column;
    line-height: 1.2;
    min-width: 0; /* Para text-overflow */
}

.header-title {
    font-weight: 500; /* Um pouco mais leve */
    font-size: 17px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.header-status {
    font-size: 12px;
    color: #d0f8ce; /* Verde claro para status */
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* Ícones no header (Estilo básico) */
.header-right {
    margin-left: auto; /* Empurra para a direita */
    display: flex;
    gap: 20px; /* Espaçamento entre ícones */
}
.header-right button {
    background: none;
    border: none;
    color: white;
    font-size: 20px; /* Tamanho dos ícones */
    cursor: pointer;
    opacity: 0.9;
}
.header-right button:hover {
    opacity: 1;
}


/* Chat Box (do MELHORADO, mas com fundo do ATUAL) */
.chat-box {
    flex: 1; /* Ocupa espaço restante */
    padding: 16px; /* Padding do ATUAL */
    overflow-y: auto; /* Scroll vertical */
    -webkit-overflow-scrolling: touch; /* Scroll suave iOS */
    background-color: #efeae2; /* Cor de fundo WhatsApp */
    background-image: url("data:image/svg+xml,%3Csvg width='100%25' height='100%25' viewBox='0 0 800 800' xmlns='http://www.w3.org/2000/svg'%3E%3Cdefs%3E%3Cpattern id='a' width='16' height='16' patternUnits='userSpaceOnUse'%3E%3Cpath d='M4 0H12L2.0000000000000004 16H0L8 8L4 0Z' fill='%23e0d8c8'/%3E%3C/pattern%3E%3C/defs%3E%3Crect fill='url(%23a)' width='800' height='800'/%3E%3C/svg%3E");
    display: flex;
    flex-direction: column;
    gap: 8px; /* Espaço entre mensagens */
    /* Padding inferior para compensar input e safe area */
    padding-bottom: calc(70px + env(safe-area-inset-bottom)); /* 70px ~ altura input */
}

/* Mensagens (Combinação: estrutura do ATUAL, classes do MELHORADO) */
.message {
    padding: 8px 12px; /* Padding interno */
    border-radius: 7.5px; /* Raio WhatsApp */
    max-width: 75%; /* Largura máxima */
    font-size: 14.2px; /* Tamanho fonte WhatsApp */
    line-height: 1.35;
    word-wrap: break-word; /* Quebra palavras */
    position: relative; /* Para posicionar metadados se necessário */
    box-shadow: 0 1px 1px rgba(0, 0, 0, 0.1); /* Sombra sutil */
    display: flex; /* Facilita organização interna */
    flex-direction: column; /* Empilha conteúdo e metadados */
    /* Animação suave */
    opacity: 0;
    transform: scale(0.95);
    animation: message-appear 0.3s cubic-bezier(0.215, 0.610, 0.355, 1) forwards;
}
@keyframes message-appear { /* Animação do ATUAL */
    from { opacity: 0; transform: scale(0.95) translateY(5px); }
    to { opacity: 1; transform: scale(1) translateY(0); }
}

/* Mensagem do usuário (classe do MELHORADO, estilo do ATUAL) */
.message.user { /* Equivalente a .me */
    align-self: flex-end; /* Alinha à direita */
    background-color: #dcf8c6; /* Verde WhatsApp */
    color: #000;
    border-radius: 7.5px 0 7.5px 7.5px; /* Canto superior direito reto */
    margin-left: auto; /* Garante alinhamento */
}

/* Mensagem da Clara (classe do MELHORADO, estilo do ATUAL) */
.message.clara { /* Equivalente a .her */
    align-self: flex-start; /* Alinha à esquerda */
    background-color: #ffffff; /* Branco */
    color: #000;
    border-radius: 0 7.5px 7.5px 7.5px; /* Canto superior esquerdo reto */
    margin-right: auto; /* Garante alinhamento */
}

/* Conteúdo e Metadados dentro da Mensagem (Estrutura do JS Atualizado) */
.message-content {
    /* O texto principal */
    padding-right: 10px; /* Espaço para não sobrepor metadados */
    word-break: break-word;
}
.message-meta {
    /* Container para timestamp e checkmarks */
    display: flex;
    align-items: center; /* Alinha itens na base */
    justify-content: flex-end; /* Alinha à direita dentro da div */
    margin-top: 4px; /* Espaço acima */
    margin-left: auto; /* Empurra para a direita */
    height: 15px; /* Altura fixa para alinhamento */
}
.timestamp {
    font-size: 11px; /* Tamanho timestamp WhatsApp */
    color: #8696a0; /* Cinza WhatsApp */
    white-space: nowrap;
    margin-right: 4px; /* Espaço antes dos checks */
}
.checkmarks {
    font-size: 12px;
    color: #8696a0; /* Cinza para 'sent'/'delivered' (pode ser #999 também) */
    line-height: 1;
    white-space: nowrap;
}
.checkmarks.read {
    color: #34B7F1; /* Azul WhatsApp para 'read' */
}
.checkmarks i {
    margin-left: -1px; /* Leve sobreposição dos checks duplos */
    vertical-align: middle;
}


/* Input Area (do MELHORADO, adaptada com elementos do ATUAL) */
.chat-input {
    display: flex;
    align-items: center; /* Alinha itens verticalmente */
    padding: 8px 10px; /* Padding geral */
    padding-bottom: calc(8px + env(safe-area-inset-bottom)); /* Safe area */
    border-top: 1px solid #ddd;
    background-color: #f0f0f0; /* Cinza claro WhatsApp */
    position: sticky; /* Fixo embaixo (do ATUAL) */
    bottom: 0;
    z-index: 1000;
    gap: 5px; /* Espaço entre botões e input */
}

/* Botões de ícone dentro do input area */
.chat-input .emoji-btn,
.chat-input .attach-btn {
    background: none;
    border: none;
    font-size: 24px;
    padding: 8px;
    color: #555;
    cursor: pointer;
    flex-shrink: 0;
    opacity: 0.7;
}
.chat-input .emoji-btn:hover,
.chat-input .attach-btn:hover {
    opacity: 1;
}
.chat-input .attach-btn {
     transform: rotate(45deg); /* Gira o clipe */
}

/* Campo de texto (do MELHORADO, dentro do form) */
.chat-input input[type="text"] {
    flex: 1; /* Ocupa espaço restante */
    padding: 10px 15px; /* Padding interno */
    font-size: 15px;
    border: none;
    outline: none;
    border-radius: 21px; /* Bordas arredondadas */
    background-color: #fff; /* Fundo branco */
    min-height: 22px; /* Altura mínima interna */
    box-sizing: content-box; /* Padding não aumenta a altura total */
}

/* Botão Enviar (do ATUAL, adaptado) */
.chat-input .send-btn {
    background-color: #075e54; /* Verde escuro WhatsApp */
    color: white;
    border: none;
    width: 44px;
    height: 44px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    flex-shrink: 0;
    transition: background-color 0.2s ease-in-out;
    font-size: 20px; /* Tamanho do ícone */
}
.chat-input .send-btn:hover {
    background-color: #128C7E; /* Verde mais claro no hover */
}
/* Quando tiver texto, o JS pode adicionar uma classe ou o estilo pode ser baseado no ícone */
/* Ex: .send-btn .fa-paper-plane { ... } */


/* Modal Styles (do ATUAL) */
.modal {
    /* display: none; */ /* Controlado pelo JS ou estilo inline */
    position: fixed; /* Fixo na tela inteira */
    z-index: 9999;
    left: 0; top: 0;
    width: 100%; height: 100%;
    background-color: rgba(0, 0, 0, 0.85); /* Fundo mais escuro */
    display: flex; /* Usa flex para centralizar */
    justify-content: center;
    align-items: center;
    /* Animação suave para aparecer */
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0s linear 0.3s;
}
.modal.active { /* Classe para ativar o modal via JS */
    opacity: 1;
    visibility: visible;
    transition: opacity 0.3s ease;
}

.modal-content {
    max-width: 90%;
    max-height: 85%; /* Deixa espaço para o botão fechar */
    border-radius: 5px; /* Borda sutil */
    object-fit: contain; /* Mantém proporção da imagem */
    /* Animação de zoom */
    transform: scale(0.8);
    transition: transform 0.3s ease;
}
.modal.active .modal-content {
    transform: scale(1);
}

.close {
    position: absolute;
    top: 15px; right: 25px;
    color: #fff;
    font-size: 35px;
    font-weight: bold;
    cursor: pointer;
    z-index: 10000;
    text-shadow: 0 1px 2px rgba(0,0,0,0.5);
}